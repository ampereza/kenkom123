{% extends 'accounts/accounts_base.html' %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4">Treatment Statistics Dashboard</h2>

    <!-- Navigation tabs -->
    <nav>
        <ul class="nav nav-tabs mb-4" id="statsTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="treatment-tab" data-bs-toggle="tab" data-bs-target="#treatment" 
                        type="button" role="tab" aria-controls="treatment" aria-selected="true">
                    Treatment Summary
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="poles-tab" data-bs-toggle="tab" data-bs-target="#poles" 
                        type="button" role="tab" aria-controls="poles" aria-selected="false">
                    Poles Summary
                </button>
            </li>
        </ul>
    </nav>

    <!-- Tab content -->
    <div class="tab-content" id="statsTabContent">
        <!-- Treatment Summary Tab -->
        <div class="tab-pane fade show active" id="treatment" role="tabpanel" aria-labelledby="treatment-tab">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Treatment Summary</h4>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <h5>Total Liters</h5>
                                    <h3>{{ treatment_summary.total_liters|round(2) }}</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <h5>Total Kegs</h5>
                                    <h3>{{ treatment_summary.total_kegs }}</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <h5>Total Poles</h5>
                                    <h3>{{ treatment_summary.total_poles }}</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Treatment logs Details -->
                    <div class="table-responsive mt-4">
                        <table class="table table-bordered table-striped">
                            <thead class="table-light">
                                <tr>
                                    <th>Date</th>
                                    <th>Kegs Used</th>
                                    <th>fencing_poles</th>
                                    <th>rafters</th>
                                    <th>timber</th>
                                    <th>stubs</th>
                                    <th>7m</th>
                                    <th>8m</th>
                                    <th>9m</th>
                                    <th>9m_telecom</th> 
                                    <th>10m</th>
                                    <th>10m_telecom</th>
                                    <th>11m</th>
                                    <th>12m</th>
                                    <th>12m_telecom</th>
                                    <th>14m</th>
                                    <th>16m</th> <!-- Added back the 16m column -->
                                    
                                    
                                </tr>
                            </thead>
                            <tbody>
                                {% for log in treatments %}
                                    <tr>
                                        <td>{{ log.date [:10]}}</td>
                                        <td>{{ log.kegs_used }}</td>
                                        <td>{{ log.fencing_poles }}</td>
                                        <td>{{ log.rafters }}</td>
                                        <td>{{ log.timber }}</td>
                                        <td>{{ log.stubs }}</td>
                                        <td>{{ log['7m'] }}</td>
                                        <td>{{ log['8m'] }}</td>
                                        <td>{{ log['9m'] }}</td>
                                        <td>{{ log['9m_telecom'] }}</td>
                                        <td>{{ log['10m'] }}</td>
                                        <td>{{ log['10m_telecom'] }}</td>
                                        <td>{{ log['11m'] }}</td>
                                        <td>{{ log['12m'] }}</td>
                                        <td>{{ log['12m_telecom'] }}</td>
                                        <td>{{ log['14m'] }}</td>
                                        <td>{{ log['16m'] }}</td> <!-- Added back the 16m column -->
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                </div>
            </div>
        </div>

        <!-- Poles Summary Tab -->
        <div class="tab-pane fade" id="poles" role="tabpanel" aria-labelledby="poles-tab">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Poles Summary</h4>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5>General Poles</h5>
                                    <p>Rafters: {{ poles_summary.rafters }}</p>
                                    <p>Timber: {{ poles_summary.timber }}</p>
                                    <p>Fencing Poles: {{ poles_summary.fencing_poles }}</p>
                                    <p>Stubs: {{ poles_summary.stubs }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5>Standard Poles</h5>
                                    <p>7m: {{ poles_summary['7m'] }}</p>
                                    <p>8m: {{ poles_summary['8m'] }}</p>
                                    <p>9m: {{ poles_summary['9m'] }}</p>
                                    <p>10m: {{ poles_summary['10m'] }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5>Long Poles</h5>
                                    <p>11m: {{ poles_summary['11m'] }}</p>
                                    <p>12m: {{ poles_summary['12m'] }}</p>
                                    <p>14m: {{ poles_summary['14m'] }}</p>
                                    <p>16m: {{ poles_summary['16m'] }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5>Telecom Poles</h5>
                                    <p>9m Telecom: {{ poles_summary['9m_telecom'] }}</p>
                                    <p>10m Telecom: {{ poles_summary['10m_telecom'] }}</p>
                                    <p>12m Telecom: {{ poles_summary['12m_telecom'] }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}